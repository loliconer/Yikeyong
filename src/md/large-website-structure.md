# 一个完美的大型网站应该是什么样的

![网站架构](/img/website-structure.png)

## 前端架构
- 浏览器优化技术，优化响应页面，加快浏览器页面的加载与显示，比如页面缓存、合并压缩静态资源文件等
- CDN
- 动静分离，静态资源独立部署，使用专门的二级域名
- 图片服务
- 反向代理，在应用服务器、静态资源服务器、图片服务器之前，提供页面缓存服务
- DNS，做DNS负载均衡
- HTTP2

## 应用层架构
- 开发框架
- 页面渲染，集成动态内容与模板
- 负载均衡，多台应用服务器组成集群，应对高并发
  - DNS负载均衡
  - 四层负载均衡（F5、LVS），工作在TCP协议下
  - 七层负载均衡（Nginx、haproxy），工作在HTTP协议下
- Session管理，分布式Session
  - 基于数据库的Session共享
  - 基于web容器本身的Session复制机制
  - 基于oscache/Redis/memcached进行Session共享
  - 基于Cookie的Session共享
- 动态页面静态化，静态化访问量特别大而更新不是很频繁的动态页面
- 业务拆分，分成多个小规模的产品，独立开发、部署、维护，降低系统耦合度的同时便于数据库业务分库
- 虚拟化服务器，将一台物理服务器虚拟化成多台虚拟服务器，使用较少的资源构架高可用的应用服务器集群

## 服务层架构
- 分布式消息，利用消息队列机制，实现业务与业务、业务与服务之间的异步消息发送及低耦合的业务关系
- 分布式服务，SOA
- 分布式缓存
- 分布式配置，将配置修改实时推送到应用系统，无需重启服务器

## 存储层架构
- 分布式文件
- 关系数据库
- NoSQL数据库，在内存管理、数据模型、集群分布式管理等方面有优势，如HBase
- 数据同步，多个数据中心间的同步，为了减轻数据库压力，可以将数据库的事务日志同步到其他数据中心，根据log进行数据重演，实现数据同步
- 读写分离

## 后台架构
- 内部搜索引擎
- 数据仓库，根据离线数据，提供数据分析与数据挖掘服务
- 推荐系统

## 数据采集与监控
- 浏览器数据采集，在页面中嵌入JS脚本采集用户浏览器环境与操作记录，分析用户行为
- 服务器业务数据采集，包括用户请求操作日志和业务数据
- 服务器性能数据采集，如系统负载、内存使用率、流量等
- 系统监控，将采集的数据可视化显示，根据采集到的数据自动化运维
- 系统报警，数据异常时通过邮件、短信等方式通知

## 安全架构
- Web攻击
- 数据保护，敏感信息加密传输与存储
- https + h2

## 数据中心机房架构
- 机房架构
- 机柜架构
- 服务器架构
